{
  "Row": 3,
  "Col": 2,
  "ActionType": 24,
  "Title": "add image and link by json (file path) - bookxnote",
  "Description": "",
  "Icon": "https://files.getquicker.net/_icons/8925A58662677E77D0882CDE31A4136EB5CB27FE.png",
  "Path": null,
  "DelayMs": 0,
  "Data": "{\"LimitSingleInstance\":true,\"SummaryExpression\":\"$$\",\"SubPrograms\":[{\"Id\":\"9b9aa5de-a5a8-4329-a61f-154d20583b58\",\"Icon\":null,\"Name\":\"getBookxnoteNotebookFolder\",\"Description\":\"\",\"SummaryExpression\":\"$$\",\"CreateTimeUtc\":\"2024-02-22T02:37:21.3592401Z\",\"LastEditTimeUtc\":\"2024-02-22T03:01:53.3135297+08:00\",\"IsLocalEdited\":false,\"Variables\":[{\"Key\":\"bookxnote_notebook_path\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":true,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"}],\"Steps\":[{\"StepRunnerKey\":\"sys:assign\",\"InputParams\":{\"input\":{\"VarKey\":null,\"Value\":\"D:/BookxNote/笔记\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"output\":\"bookxnote_notebook_path\",\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0}],\"SubPrograms\":[],\"TemplateId\":null,\"TemplateRevision\":0,\"UseServerVersion\":null,\"IsProtected\":null,\"SharedId\":null,\"ShareTimeUtc\":null}],\"Variables\":[{\"Key\":\"text\",\"Type\":0,\"Desc\":\"默认的文本变量\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":null,\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":null},{\"Key\":\"img\",\"Type\":3,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":null},{\"Key\":\"base64\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"file\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":null},{\"Key\":\"link\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"isImage\",\"Type\":2,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"page\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"bookxnote_notebook_path\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"notebooks_json_path\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"notebooks_json\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"notebook_id\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"notebooks\",\"Type\":99,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"notebook_json_path\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"uuid\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"notebook_json\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"},{\"Key\":\"bookxnote_link\",\"Type\":0,\"Desc\":\"\",\"DefaultValue\":\"\",\"SaveState\":false,\"IsInput\":false,\"IsOutput\":false,\"ParamName\":\"\",\"InputParamInfo\":null,\"OutputParamInfo\":null,\"TableDef\":null,\"CustomType\":null,\"Group\":\"\"}],\"Steps\":[{\"StepRunnerKey\":\"sys:sendKeys\",\"InputParams\":{\"keys\":{\"VarKey\":null,\"Value\":\"^%c\"}},\"OutputParams\":{},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:getClipboardText\",\"InputParams\":{\"format\":{\"VarKey\":null,\"Value\":\"UnicodeText\"},\"waitMs\":{\"VarKey\":null,\"Value\":\"400\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"output\":\"bookxnote_link\",\"url\":null,\"elapsedMs\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:regexExtract\",\"InputParams\":{\"getGroup\":{\"VarKey\":null,\"Value\":\"1\"},\"data\":{\"VarKey\":\"bookxnote_link\",\"Value\":null},\"pattern\":{\"VarKey\":null,\"Value\":\"page=(\\\\d+)\"},\"ignoreCase\":{\"VarKey\":null,\"Value\":\"false\"},\"singleLine\":{\"VarKey\":null,\"Value\":\"false\"},\"multiLine\":{\"VarKey\":null,\"Value\":\"false\"},\"rightToLeft\":{\"VarKey\":null,\"Value\":\"false\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"matches\":null,\"match1 \":\"page\",\"match2 \":null,\"match3 \":null,\"match4 \":null,\"match5 \":null,\"matchObj\":null,\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:assign\",\"InputParams\":{\"input\":{\"VarKey\":null,\"Value\":\"$=$\\\"[page: {{page}}]({{bookxnote_link}})\\\"\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"output\":\"link\",\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:sendKeys\",\"InputParams\":{\"keys\":{\"VarKey\":null,\"Value\":\"^+c\"}},\"OutputParams\":{},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:getClipboardImage\",\"InputParams\":{\"stopIfFail\":{\"VarKey\":null,\"Value\":\"0\"}},\"OutputParams\":{\"isSuccess\":\"isImage\",\"output\":\"img\",\"elapsedMs\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:if\",\"InputParams\":{\"condition\":{\"VarKey\":\"isImage\",\"Value\":null}},\"OutputParams\":{},\"IfSteps\":[{\"StepRunnerKey\":\"sys:subprogram\",\"InputParams\":{\"subProgram\":{\"VarKey\":null,\"Value\":\"getBookxnoteNotebookFolder\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"},\"skipDebugOutput\":{\"VarKey\":null,\"Value\":\"1\"},\"summary\":{\"VarKey\":null,\"Value\":\"\"}},\"OutputParams\":{\"isSuccess\":null,\"var:bookxnote_notebook_path\":\"bookxnote_notebook_path\",\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:assign\",\"InputParams\":{\"input\":{\"VarKey\":null,\"Value\":\"$={bookxnote_notebook_path}+\\\"/notebooks/manifest.json\\\"\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"output\":\"notebooks_json_path\",\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:readFile\",\"InputParams\":{\"path\":{\"VarKey\":\"notebooks_json_path\",\"Value\":null},\"type\":{\"VarKey\":null,\"Value\":\"text\"},\"encoding\":{\"VarKey\":null,\"Value\":\"utf-8\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"txt\":\"notebooks_json\",\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:regexExtract\",\"InputParams\":{\"getGroup\":{\"VarKey\":null,\"Value\":\"1\"},\"data\":{\"VarKey\":\"bookxnote_link\",\"Value\":null},\"pattern\":{\"VarKey\":null,\"Value\":\"nb=({.*?})\"},\"ignoreCase\":{\"VarKey\":null,\"Value\":\"false\"},\"singleLine\":{\"VarKey\":null,\"Value\":\"false\"},\"multiLine\":{\"VarKey\":null,\"Value\":\"false\"},\"rightToLeft\":{\"VarKey\":null,\"Value\":\"false\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"matches\":null,\"match1 \":\"notebook_id\",\"match2 \":null,\"match3 \":null,\"match4 \":null,\"match5 \":null,\"matchObj\":null,\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:jsscript\",\"InputParams\":{\"script\":{\"VarKey\":null,\"Value\":\"//.js 主函数 exec()\\r\\nfunction exec(){\\r\\n var json = quickerGetVar('notebooks_json');\\r\\n var id = quickerGetVar('notebook_id');\\r\\n var notebooks = JSON.parse(json)\\r\\n var entry = ''\\r\\n for (var n of notebooks.notebooks) {\\r\\n \\tif (n.id == id) {\\r\\n \\t\\tentry = n.entry;\\r\\n \\t\\tbreak;\\r\\n \\t}\\r\\n }\\r\\n quickerSetVar('entry',  entry);\\r\\n return 0;\\r\\n}\\r\\n\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"return\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:assign\",\"InputParams\":{\"input\":{\"VarKey\":null,\"Value\":\"$={bookxnote_notebook_path}+$\\\"/notebooks/{{entry}}/markups.json\\\"\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"output\":\"notebook_json_path\",\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:readFile\",\"InputParams\":{\"path\":{\"VarKey\":\"notebook_json_path\",\"Value\":null},\"type\":{\"VarKey\":null,\"Value\":\"text\"},\"encoding\":{\"VarKey\":null,\"Value\":\"utf-8\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"txt\":\"notebook_json\",\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:regexExtract\",\"InputParams\":{\"getGroup\":{\"VarKey\":null,\"Value\":\"1\"},\"data\":{\"VarKey\":\"bookxnote_link\",\"Value\":null},\"pattern\":{\"VarKey\":null,\"Value\":\"uuid=(.*)\"},\"ignoreCase\":{\"VarKey\":null,\"Value\":\"false\"},\"singleLine\":{\"VarKey\":null,\"Value\":\"false\"},\"multiLine\":{\"VarKey\":null,\"Value\":\"false\"},\"rightToLeft\":{\"VarKey\":null,\"Value\":\"false\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"matches\":null,\"match1 \":\"uuid\",\"match2 \":null,\"match3 \":null,\"match4 \":null,\"match5 \":null,\"matchObj\":null,\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:jsscript\",\"InputParams\":{\"script\":{\"VarKey\":null,\"Value\":\"//.js 主函数 exec()\\r\\nfunction exec(){\\r\\n var json = quickerGetVar('notebook_json');\\r\\n var uuid = quickerGetVar('uuid');\\r\\n var notebooks = JSON.parse(json)\\r\\n var imgfile = ''\\r\\n for (var m of notebooks.markups) {\\r\\n \\tif (m.uuid == uuid) {\\r\\n \\t\\timgfile = m.imgfile;\\r\\n \\t\\tbreak;\\r\\n \\t}\\r\\n }\\r\\n quickerSetVar('imgfile',  imgfile);\\r\\n return 0;\\r\\n}\\r\\n\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"return\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:writeClipboard\",\"InputParams\":{\"type\":{\"VarKey\":null,\"Value\":\"auto\"},\"input\":{\"VarKey\":null,\"Value\":\"$=\\\"ymjr:image-link\\\" + JsonConvert.SerializeObject(\\r\\nnew{\\r\\n    link = {link},\\r\\n    img_path = {bookxnote_notebook_path}+$\\\"/notebooks/{{entry}}/imgfiles/{{imgfile}}\\\"\\r\\n}\\r\\n)\"},\"successMsg\":{\"VarKey\":null,\"Value\":\"\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0}],\"ElseSteps\":[{\"StepRunnerKey\":\"sys:getClipboardText\",\"InputParams\":{\"format\":{\"VarKey\":null,\"Value\":\"UnicodeText\"},\"waitMs\":{\"VarKey\":null,\"Value\":\"400\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"output\":\"text\",\"url\":null,\"elapsedMs\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0},{\"StepRunnerKey\":\"sys:writeClipboard\",\"InputParams\":{\"type\":{\"VarKey\":null,\"Value\":\"auto\"},\"input\":{\"VarKey\":null,\"Value\":\"$=\\\"ymjr:text-link\\\" + JsonConvert.SerializeObject(\\r\\nnew{\\r\\n    link = {link},\\r\\n    text = {text}\\r\\n}\\r\\n)\"},\"successMsg\":{\"VarKey\":null,\"Value\":\"\"},\"stopIfFail\":{\"VarKey\":null,\"Value\":\"1\"}},\"OutputParams\":{\"isSuccess\":null,\"errMessage\":null},\"IfSteps\":null,\"ElseSteps\":null,\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0}],\"Note\":\"\",\"Disabled\":false,\"Collapsed\":false,\"DelayMs\":0}]}",
  "Data2": null,
  "Data3": null,
  "Children": null,
  "Id": "c0147953-f978-4a6f-92e0-383267bb5fc7",
  "TemplateId": null,
  "TemplateRevision": 0,
  "UseTemplate": false,
  "LastEditTimeUtc": "2024-02-22T05:11:36.7922308+08:00",
  "SharedActionId": "",
  "ShareTimeUtc": null,
  "CreateTimeUtc": "2024-02-22T02:38:03.8021131Z",
  "AsSubProgram": false,
  "SkipWhenStopRunningActions": false,
  "SkipCheckUpdate": false,
  "AutoUpdate": false,
  "KeepInfoWhenUpdate": false,
  "MinQuickerVersion": "",
  "ContextMenuData": "",
  "AllowScrollTrigger": false,
  "EnableEvaluateVariable": false,
  "IsTextProcessor": false,
  "IsImageProcessor": false,
  "Association": {
    "MatchProcess": null,
    "IsImageProcessor": false,
    "ReturnImageFromFirstScreenShotStep": true,
    "IsTextProcessor": false,
    "ReturnTextFromGetSelectedTextStep": true,
    "TextMatchExpression": "",
    "TextMinLength": 0,
    "TextMaxLength": 0,
    "IsHtmlProcessor": false,
    "IsFileProcessor": false,
    "FileMinCount": 0,
    "FileMaxCount": 0,
    "AllowedFileExtensions": "",
    "RequireAllFileMatchExt": false,
    "SearchBoxPlaceholder": "",
    "IsWindowProcessor": false,
    "EnableRealtimeSearch": false,
    "BrowserContextMenu": null,
    "UrlPattern": ""
  },
  "DoNotClosePanel": false,
  "UserLimitation": null
}